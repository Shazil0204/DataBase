CREATE DATABASE Performance;

USE Performance;

CREATE TABLE Random(
	id INT NOT NULL,
	RandomNumber INT NOT NULL,
	PRIMARY KEY (id)
);

-- OPG 1

select CURRENT_TIMESTAMP
Select * from Random where RandomNumber = 4711;
select CURRENT_TIMESTAMP

-- BEFORE INDEX
-- START TIME (13:16:53.143) || STOP TIME (13:16:53.230)
-- AFTER INDEX
-- START TIME (2023-08-24 13:23:48.820) || STOP TIME (2023-08-24 13:23:49.030)

-- OPG 2

select CURRENT_TIMESTAMP
CREATE VIEW RandomNumberCountView AS
SELECT RandomNumber, COUNT(RandomNumber) AS CountOfRandomNumber
FROM Random
GROUP BY RandomNumber;

SELECT * FROM RandomNumberCountView
ORDER BY RandomNumber;
select CURRENT_TIMESTAMP

-- BEFORE INDEX
-- START TIME (13:17:37.717) || STOP TIME (13:17:37.870)
-- AFTER INDEX
-- START TIME (2023-08-24 13:25:11.977) || STOP TIME (2023-08-24 13:25:12.347)

-- OPG 3

select CURRENT_TIMESTAMP
SELECT * FROM RandomNumberCountView
ORDER BY CountOfRandomNumber;
select CURRENT_TIMESTAMP

-- BEFORE INDEX
-- START TIME (13:18:07.930) || STOP TIME (13:18:08.097)
-- AFTER INDEX
-- START TIME (2023-08-24 13:25:57.970) || STOP TIME (2023-08-24 13:25:58.290)

-- OPG 4

select CURRENT_TIMESTAMP
SELECT * FROM RandomNumberCountView
ORDER BY CountOfRandomNumber DESC;
select CURRENT_TIMESTAMP

-- BEFORE INDEX
-- START TIME (13:18:35.403) || STOP TIME (13:18:35.563)
-- AFTER INDEX
-- START TIME (2023-08-24 13:26:18.950) || STOP TIME (2023-08-24 13:26:19.310)

-- OPG 5
select CURRENT_TIMESTAMP
SELECT top 1 * FROM RandomNumberCountView
ORDER BY CountOfRandomNumber DESC;

SELECT top 1 * FROM RandomNumberCountView
ORDER BY CountOfRandomNumber;
select CURRENT_TIMESTAMP

-- BEFORE INDEX
-- START TIME (13:19:00.250) || STOP TIME (13:19:00.350)
-- AFTER INDEX
-- START TIME (2023-08-24 13:26:50.297) || STOP TIME (2023-08-24 13:26:50.520)

CREATE INDEX INDEXNAME ON Random( ID, RandomNumber);


-- STORE PROCEDURE
-- This one is to Get RandomNumber By ID
CREATE PROCEDURE GetRandomNumberByID(@sp_ID INT)
AS
BEGIN
    SELECT RandomNumber FROM Random WHERE ID = @sp_ID
END

-- This one is to Get IDs By RandomNumber
CREATE PROCEDURE GetIDsByRandomNumber(@sp_RandomNumber INT)
AS
BEGIN
    SELECT ID FROM Random WHERE RandomNumber = @sp_RandomNumber
END